{{ define "main" }}

<h5>{{page.title}}</h5>

{{ $thelyrics := cond (eq .lang "da") "tekster" "lyrics" }}

{{ printf "%#v" .Site.Data.albums }}

{{ range site.Data.albums }}
<div class="discography">
  <div class="cover"><img src="/images/covers/{{ .params.cover.small }}" alt="{{ .params.album }}"/><p class="lyrics"><a href="{{ $thelyrics }}.html#{{ .params.lyricsfragid }}">{{ $thelyrics }}</a></p></div>
  <div class="albuminfo">
    <p class="discinfo">
      <span class="artist">{{ .artist }}</span> //
      <span class="title">{{ .album }}</span> ({{ .year}}) <br />
      {{ .label.name }} // {{ .label.id }}
      {{ if .label.web }}
        <br />
        {{ $thetitle := cond .params.label.webtitle .params.label.webtitle .params.label.web }}
        <a href="{{ .params.label.web }}">{{ $thetitle }}</a>
      {{ end }}
      {{ if and .params.label.web .params.label.email }} // {{ end }}
      {{ if .label.email }}
      <a href="mailto:{{ .label.email }}">{{ .label.email }}</a>
      {{ end }}
    </p>
    <p class="trackinfo"><span class="head">Tracklist:</span><br />
    {{ range .params.tracklist }}
      {{ .track.title }}{% unless forloop.last %} // {% endunless%}
    {{ end }}
    </p>

    <p class="members"><span class="head">{{ .params.artist }}</span><br />
      {{ $crewSize := (len .params.crew) }}
      {{ range $index, $element := .params.crew }}
        {{ .name }} ({{ index .instrument page.lang }})
        {{ if lt (add $index 1 ) $crewSize }} // {{ end }}
      {{ end }}
      {{ if .params.guests }}
      <strong><em>{{ if eq .params.lang "da" }}med{{ else }}with{{ end }}</em></strong><br>
      {{ $guestsSize := (len .params.guests) }}
      {{ range $index, $element := .params.guests }}
        {{ .name }} ({{ index .instrument page.lang }})
        {{ if lt (add $index 1 ) $guestsSize }} // {{ end }}
      {{ end }}
      {{ end }}
    </p>
  </div>
</div>
{{ end }}

{{ end }}
